<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Galactic Siege - No Spin Media</title>
  <link rel="stylesheet" href="/style.css">
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
    }
    #game-container {
      display: flex;
      justify-content: center;
      padding: 20px;
      gap: 30px;
    }
    #game-box {
      border: 2px solid #0f0;
      box-shadow: 0 0 20px #0f0;
      padding: 10px;
      border-radius: 8px;
      background: #000;
    }
    #game-header {
      text-align: center;
      color: #0f0;
      font-size: 1.8em;
      margin-bottom: 5px;
    }
    #game-info {
      text-align: center;
      margin-bottom: 10px;
      color: #0f0;
      font-weight: bold;
    }
    canvas {
      background: #000;
      display: block;
      border: 2px solid #0f0;
      margin: auto;
    }
    #sidebar {
      background: #111;
      border: 2px solid #0f0;
      box-shadow: 0 0 15px #0f0;
      padding: 20px;
      border-radius: 8px;
      max-width: 250px;
      height: fit-content;
    }
    #sidebar h2 {
      color: #0f0;
      text-align: center;
    }
    #donate-button {
      background-color: #ffd700;
      color: #000;
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      margin: 10px auto;
      display: block;
    }
    #controls {
      text-align: center;
      margin-top: 10px;
    }
    .control-btn {
      background: #008000;
      color: #fff;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
    }
    .share-buttons {
      text-align: center;
      margin: 10px;
    }
    .share-buttons button {
      padding: 6px 12px;
      margin: 0 5px;
      background: #0073e6;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <!-- âœ… Universal Header -->
  <div id="site-header"></div>
  <script>
    fetch('/header.html')
      .then(res => res.text())
      .then(html => document.getElementById('site-header').innerHTML = html);
  </script>

  <div id="game-container">
    <div id="game-box">
      <div id="game-header">Galactic Siege ðŸ‘¾</div>
      <div id="game-info">
        Score: <span id="score">0</span> | 
        Lives: <span id="lives">3</span> | 
        High Score: <span id="highScore">0</span> | 
        Level: <span id="level">1</span>
      </div>

      <div class="share-buttons">
        <button id="shareBtn">ðŸ”— Share with Friends</button>
        <button id="copyBtn">ðŸ“‹ Copy Link</button>
      </div>

      <canvas id="gameCanvas" width="600" height="500"></canvas>
      <div id="controls">
        <button class="control-btn" id="startBtn">Start Game</button>
        <button class="control-btn" id="resetBtn">Reset Game</button>
      </div>
    </div>

    <div id="sidebar">
      <h2>Support Us!</h2>
      <p>If you enjoy ad-free games from No Spin Media, consider supporting us.</p>
      <button id="donate-button" onclick="window.location.href='/sponsor.html'">Donate Now</button>
      <p style="font-size: 0.8em; color: #aaa;">Your help keeps No Spin Media alive and growing.</p>
    </div>
  </div>

  <footer style="text-align:center;color:#666;padding:10px;">
    Â© 2025 No Spin Media. Independent. Ad-free. Truth-focused.
  </footer>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    let player = { x: 280, y: 460, width: 40, height: 30, dx: 0 };
    let bullets = [];
    let aliens = [];
    let alienDir = 1;
    let score = 0, highScore = localStorage.getItem('galacticSiegeHighScore') || 0, lives = 3, level = 1;
    let shields = [];
    let gameRunning = false;

    const ALIEN_ROWS = 3;
    const ALIEN_COLS = 8;
    const BULLET_SPEED = 7;
    const PLAYER_SPEED = 6;

    function createAliens() {
      aliens = [];
      for (let r = 0; r < ALIEN_ROWS; r++) {
        for (let c = 0; c < ALIEN_COLS; c++) {
          aliens.push({ x: 50 + c * 60, y: 50 + r * 50, width: 30, height: 20 });
        }
      }
    }

    function createShields() {
      shields = [];
      for (let i = 0; i < 4; i++) {
        shields.push({ x: 80 + i * 120, y: 400, width: 60, height: 20, health: 6 });
      }
    }

    function drawPlayer() {
      ctx.fillStyle = "#fff";
      ctx.beginPath();
      ctx.moveTo(player.x + player.width / 2, player.y); // Nose
      ctx.lineTo(player.x, player.y + player.height);
      ctx.lineTo(player.x + player.width, player.y + player.height);
      ctx.closePath();
      ctx.fill();
      ctx.fillStyle = "#00f"; // Cockpit
      ctx.fillRect(player.x + player.width / 2 - 5, player.y + 10, 10, 8);
    }

    function drawAlien(a) {
      ctx.fillStyle = "#f00";
      ctx.fillRect(a.x, a.y, a.width, a.height / 2);
      ctx.fillStyle = "#ff0";
      ctx.fillRect(a.x, a.y + a.height / 2, a.width, a.height / 2);
    }

    function drawShields() {
      shields.forEach(s => {
        if (s.health > 0) {
          ctx.fillStyle = s.health > 4 ? "#0f0" : s.health > 2 ? "#ffa500" : "#f00";
          ctx.fillRect(s.x, s.y, s.width, s.height);
        }
      });
    }

    function update() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Player
      player.x += player.dx;
      if (player.x < 0) player.x = 0;
      if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
      drawPlayer();

      // Bullets
      bullets.forEach((b, i) => {
        b.y -= BULLET_SPEED;
        ctx.fillStyle = "#0ff";
        ctx.fillRect(b.x, b.y, 3, 10);
        if (b.y < 0) bullets.splice(i, 1);

        // Collision with aliens
        aliens.forEach((a, j) => {
          if (b.x < a.x + a.width && b.x + 3 > a.x && b.y < a.y + a.height && b.y + 10 > a.y) {
            aliens.splice(j, 1);
            bullets.splice(i, 1);
            score += 10;
            updateHUD();
          }
        });
      });

      // Aliens
      let edgeHit = false;
      aliens.forEach(a => {
        a.x += alienDir;
        if (a.x < 0 || a.x + a.width > canvas.width) edgeHit = true;
        drawAlien(a);
      });
      if (edgeHit) {
        alienDir *= -1;
        aliens.forEach(a => a.y += 10);
      }

      // Shields
      drawShields();

      if (aliens.length === 0) nextLevel();

      requestAnimationFrame(update);
    }

    function updateHUD() {
      document.getElementById('score').innerText = score;
      document.getElementById('lives').innerText = lives;
      document.getElementById('highScore').innerText = highScore;
      document.getElementById('level').innerText = level;
    }

    function startGame() {
      createAliens();
      createShields();
      gameRunning = true;
      score = 0;
      lives = 3;
      level = 1;
      updateHUD();
      update();
    }

    function nextLevel() {
      level++;
      createAliens();
      createShields();
    }

    document.addEventListener('keydown', e => {
      if (e.key === "ArrowLeft") player.dx = -PLAYER_SPEED;
      if (e.key === "ArrowRight") player.dx = PLAYER_SPEED;
      if (e.key === " ") {
        bullets.push({ x: player.x + player.width / 2, y: player.y });
      }
    });

    document.addEventListener('keyup', e => {
      if (e.key === "ArrowLeft" || e.key === "ArrowRight") player.dx = 0;
    });

    document.getElementById('startBtn').onclick = startGame;
    document.getElementById('resetBtn').onclick = startGame;

    updateHUD();
  </script>
</body>
</html>
