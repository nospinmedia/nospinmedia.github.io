<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8" />
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  Â  <title>No Spin Media News Stories</title>
Â  Â  <link rel="stylesheet" href="style.css" />
Â  Â  <style>
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  background: #f4f4f4;
Â  Â  Â  Â  Â  Â  color: #222;
Â  Â  Â  Â  Â  Â  padding-top: 70px;
Â  Â  Â  Â  }
/* RESTORE BEAUTIFUL INPUT & BUTTON STYLING */
input[type="text"],
input[type="email"],
textarea {
Â  Â  width: 100%;
Â  Â  padding: 12px;
Â  Â  margin: 8px 0;
Â  Â  border: 1px solid #ccc;
Â  Â  border-radius: 6px;
Â  Â  font-size: 1rem;
Â  Â  box-sizing: border-box;
}

button[type="submit"] {
Â  Â  background: #0073e6;
Â  Â  color: #fff;
Â  Â  border: none;
Â  Â  padding: 12px;
Â  Â  width: 100%;
Â  Â  font-weight: bold;
Â  Â  border-radius: 6px;
Â  Â  cursor: pointer;
}

button[type="submit"]:hover {
Â  Â  background: #005bb5;
}

#formStatus {
Â  Â  font-size: 0.9em;
Â  Â  margin: 6px 0;
Â  Â  text-align: center;
}

Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  max-width: 1200px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  padding: 1rem;
Â  Â  Â  Â  Â  Â  gap: 2rem;
Â  Â  Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  }

Â  Â  Â  Â  .main { flex: 2; }
Â  Â  Â  Â  .sidebar {
Â  Â  Â  Â  Â  Â  flex: 1;
Â  Â  Â  Â  Â  Â  background: #fff;
Â  Â  Â  Â  Â  Â  padding: 1rem;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
Â  Â  Â  Â  Â  Â  height: fit-content;
Â  Â  Â  Â  Â  Â  border-left: 2px solid #eee;
Â  Â  Â  Â  Â  Â  align-self: flex-start;
Â  Â  Â  Â  }

Â  Â  Â  Â  .date-group { margin-bottom: 2rem; }
Â  Â  Â  Â  .date-header {
Â  Â  Â  Â  Â  Â  background: #333; color: #fff;
Â  Â  Â  Â  Â  Â  padding: 0.5rem 1rem;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  font-weight: bold; font-size: 1.2rem;
Â  Â  Â  Â  }

Â  Â  Â  Â  .story-card {
Â  Â  Â  Â  Â  Â  background: #fff;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  padding: 1rem;
Â  Â  Â  Â  Â  Â  margin: 0.8rem 0;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  .story-card h3 {
Â  Â  Â  Â  Â  Â  font-size: 1.3rem;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .bias {
Â  Â  Â  Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  Â  Â  margin-top: 0.3rem;
Â  Â  Â  Â  }

Â  Â  Â  Â  .summary {
Â  Â  Â  Â  Â  Â  max-height: 0;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transition: all 0.4s ease;
Â  Â  Â  Â  Â  Â  white-space: pre-line;
Â  Â  Â  Â  Â  Â  margin-top: 0.5rem;
Â  Â  Â  Â  }
Â  Â  Â  Â  .summary.show {
Â  Â  Â  Â  Â  Â  max-height: 1000px;
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  }

Â  Â  Â  Â  button.toggle, button.share-btn {
Â  Â  Â  Â  Â  Â  margin-top: 0.6rem;
Â  Â  Â  Â  Â  Â  padding: 6px 12px;
Â  Â  Â  Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  border: 1px solid #333;
Â  Â  Â  Â  Â  Â  background: #333;
Â  Â  Â  Â  Â  Â  color: #fff;
Â  Â  Â  Â  }
Â  Â  Â  Â  button.toggle:hover, button.share-btn:hover { background: #555; }

Â  Â  Â  Â  button.share-btn {
Â  Â  Â  Â  Â  Â  margin-left: 10px;
Â  Â  Â  Â  Â  Â  font-size: 0.8rem;
Â  Â  Â  Â  Â  Â  background: #0066cc;
Â  Â  Â  Â  Â  Â  border-color: #0066cc;
Â  Â  Â  Â  }
Â  Â  Â  Â  button.share-btn:hover { background: #004c99; }

Â  Â  Â  Â  footer {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  padding: 1rem;
Â  Â  Â  Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  }

Â  Â  Â  Â  @media (max-width: 768px) {
Â  Â  Â  Â  Â  Â  .container { flex-direction: column; }
Â  Â  Â  Â  Â  Â  .sidebar {
Â  Â  Â  Â  Â  Â  Â  Â  margin-top: 1rem;
Â  Â  Â  Â  Â  Â  Â  Â  border-left: none;
Â  Â  Â  Â  Â  Â  Â  Â  border-top: 2px solid #eee;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

<div id="site-header"></div>

<div class="container">
Â  Â  <div class="main">
Â  Â  Â  Â  <h1>Unpublished News Stories</h1>
Â  Â  Â  Â  <div id="stories-container"></div>
Â  Â  </div>

Â  Â  <div class="sidebar">
Â  Â  Â  Â  <h2>Support Us ğŸ’™</h2>
Â  Â  Â  Â  <p>Like what we're doing? Help keep No Spin Media running:</p>
Â  Â  Â  Â  <p><strong>Venmo:</strong><br/>
Â  Â  Â  Â  Â  Â  <a href="https://venmo.com/NoSpinMedia" target="_blank">@NoSpinMedia</a>
Â  Â  Â  Â  </p>

<h2>Follow Us</h2>

<p>
Â  Â  ğŸ“˜ <a href="https://facebook.com/NoSpinNewsAI" target="_blank">
Â  Â  Â  Â  facebook.com/NoSpinNewsAI
Â  Â  </a>
</p>

<p>
Â  Â  ğŸ”º <a href="https://reddit.com/r/NoSpinMedia" target="_blank">
Â  Â  Â  Â  reddit.com/r/NoSpinMedia
Â  Â  </a>
</p>
Â  Â  Â  Â  <h2>We â¤ï¸ Your Thoughts!</h2>
Â  Â  Â  Â  <p>You can also reach us directly at: <strong>nospinmedia.ai@gmail.com</strong></p>

Â  Â  Â  Â  <form id="feedbackForm">
Â  Â  Â  Â  Â  Â  <input type="text" id="name" name="name" placeholder="Your first name">
Â  Â  Â  Â  Â  Â  <input type="email" id="email" name="email" placeholder="you@email.com" required>
Â  Â  Â  Â  Â  Â  <textarea id="message" name="message" rows="4" placeholder="Your feedback..." required></textarea>
Â  Â  Â  Â  Â  Â  <p id="formStatus"></p>
Â  Â  Â  Â  Â  Â  <button type="submit">ğŸ’¬ Send Feedback</button>
Â  Â  Â  Â  </form>
Â  Â  </div>
</div>

<footer>
Â  Â  Â© 2025 No Spin Media. Independent. Truth-focused.<br>Seriously factual, surprisingly fun.
</footer>

<script>
/* IDENTICAL PAGE â€” only loadStories() is modified */
let storyId = null;

function getQueryParam(param) {
Â  Â  const urlParams = new URLSearchParams(window.location.search);
Â  Â  return urlParams.get(param);
}

function formatDateLabel(dateStr) {
Â  Â  if (!/^\d{4}-\d{2}-\d{2}$/.test(dateStr)) return dateStr || 'Undated';
Â  Â  const [y,m,d] = dateStr.split('-');
Â  Â  const months = ["January","February","March","April","May","June","July","August","September","October","November","December"];
Â  Â  const weekdays = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
Â  Â  const fakeDate = new Date(Number(y), Number(m)-1, Number(d));
Â  Â  return `${weekdays[fakeDate.getDay()]}, ${months[Number(m)-1]} ${Number(d)}, ${y}`;
}

async function loadStories() {
Â  Â  storyId = getQueryParam('id');

Â  Â  // ğŸ”¥ Use unpublished posts
Â  Â  const apiURL = "https://data.nospin.media/unpublished";
Â  Â  const response = await fetch(apiURL);
Â  Â  let stories = await response.json();

Â  Â  // ---- POST SLOTS (EST) ----
Â  Â  const slots = [
Â  Â  Â  Â  "00:30", "06:15", "08:45", "10:15", "11:45",
Â  Â  Â  Â  "13:15", "15:45", "17:15", "18:30", "20:45"
Â  Â  ];

Â  Â  // ---- FIND NEXT AVAILABLE SLOT ----
Â  Â  function nextSlotFrom(now) {
Â  Â  Â  Â  const est = new Date(
Â  Â  Â  Â  Â  Â  now.toLocaleString("en-US", { timeZone: "America/New_York" })
Â  Â  Â  Â  );
Â  Â  Â  Â  const today = est.toISOString().split("T")[0];

Â  Â  Â  Â  for (let s of slots) {
Â  Â  Â  Â  Â  Â  const dt = new Date(`${today}T${s}:00-05:00`);
Â  Â  Â  Â  Â  Â  if (dt > est) return dt;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Tomorrow, first slot
Â  Â  Â  Â  const tomorrow = new Date(est.getTime() + 86400000);
Â  Â  Â  Â  const tStr = tomorrow.toISOString().split("T")[0];
Â  Â  Â  Â  return new Date(`${tStr}T${slots[0]}:00-05:00`);
Â  Â  }

Â  Â  let currentSlot = nextSlotFrom(new Date());

// ---- ASSIGN SLOTS (SAFE VERSION, NEVER BREAKS) ----
let slotPointer = 0;Â Â 

// First find the next slot pointer
(function initSlotPointer() {
Â  Â  const estNow = new Date(
Â  Â  Â  Â  new Date().toLocaleString("en-US", { timeZone: "America/New_York" })
Â  Â  );
Â  Â  const today = estNow.toISOString().split("T")[0];

Â  Â  for (let i = 0; i < slots.length; i++) {
Â  Â  Â  Â  const dt = new Date(`${today}T${slots[i]}:00-05:00`);
Â  Â  Â  Â  if (dt > estNow) {
Â  Â  Â  Â  Â  Â  slotPointer = i;
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // If we got here, all slots today are past â€” start at tomorrow slot 0
Â  Â  slotPointer = 0;
})();

let currentDay = new Date(
Â  Â  new Date().toLocaleString("en-US", { timeZone: "America/New_York" })
);

for (let i = 0; i < stories.length; i++) {
Â  Â  // Build the scheduled datetime
Â  Â  const dateStr = currentDay.toISOString().split("T")[0];
Â  Â  const slotStr = slots[slotPointer];

Â  Â  const scheduled = new Date(`${dateStr}T${slotStr}:00-05:00`);
Â  Â  stories[i].scheduled = scheduled.toISOString();

Â  Â  // Move pointer forward
Â  Â  slotPointer++;
Â  Â  if (slotPointer >= slots.length) {
Â  Â  Â  Â  slotPointer = 0;

Â  Â  Â  Â  // Move to next day
Â  Â  Â  Â  const next = new Date(currentDay.getTime() + 86400000);
Â  Â  Â  Â  currentDay = next;
Â  Â  }
}

Â  Â  // ---- GROUP BY DATE ----
Â  Â  const groups = {};
Â  Â  stories.forEach(r => {
Â  Â  Â  Â  const d = r.scheduled.split("T")[0];
Â  Â  Â  Â  if (!groups[d]) groups[d] = [];
Â  Â  Â  Â  groups[d].push(r);
Â  Â  });

Â  Â  // ---- RENDER ----
Â  Â  const container = document.getElementById("stories-container");
Â  Â  container.innerHTML = "";

Â  Â  const months = ["January","February","March","April","May","June","July","August","September","October","November","December"];
Â  Â  const weekdays = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];

Â  Â  for (const date in groups) {
Â  Â  Â  Â  const dt = new Date(date + "T00:00:00");
Â  Â  Â  Â  const label = `${weekdays[dt.getDay()]}, ${months[dt.getMonth()]} ${dt.getDate()}, ${dt.getFullYear()}`;

Â  Â  Â  Â  const dateGroup = document.createElement("div");
Â  Â  Â  Â  dateGroup.className = "date-group";
Â  Â  Â  Â  dateGroup.innerHTML = `<div class="date-header">${label}</div>`;

Â  Â  Â  Â  groups[date].forEach(story => {
Â  Â  Â  Â  Â  Â  const sched = new Date(story.scheduled);
Â  Â  Â  Â  Â  Â  const timeLabel = sched.toLocaleTimeString("en-US", {
Â  Â  Â  Â  Â  Â  Â  Â  timeZone: "America/New_York",
Â  Â  Â  Â  Â  Â  Â  Â  hour: "numeric",
Â  Â  Â  Â  Â  Â  Â  Â  minute: "2-digit"
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  const card = document.createElement("div");
Â  Â  Â  Â  Â  Â  card.className = "story-card";
Â  Â  Â  Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <h3>${story.headline}</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bias">Scheduled: <strong>${timeLabel} EST</strong></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bias">Bias: ${story.bias}</div>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="toggle" onclick="toggleSummary(this)">Show Story</button>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="summary">${story.summary}</div>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  dateGroup.appendChild(card);
Â  Â  Â  Â  });

Â  Â  Â  Â  container.appendChild(dateGroup);
Â  Â  }
}


/* LOAD HEADER + THEN LOAD STORIES (required!) */
document.addEventListener('DOMContentLoaded', function() {
Â  Â  fetch('header.html')
Â  Â  Â  Â  .then(res => res.text())
Â  Â  Â  Â  .then(html => {
Â  Â  Â  Â  Â  Â  document.getElementById('site-header').innerHTML = html;
Â  Â  Â  Â  Â  Â  loadStories();Â  Â // â† THIS is what loads your unpublished posts
Â  Â  Â  Â  })
Â  Â  Â  Â  .catch(err => console.error("Error loading header.html:", err));
});
Â  Â Â 
Â  Â  document.addEventListener("DOMContentLoaded", () => {
Â  Â  const feedbackForm = document.getElementById('feedbackForm');

Â  Â  if (feedbackForm) {
Â  Â  Â  Â  feedbackForm.addEventListener('submit', async function(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const name = document.getElementById('name').value.trim();
Â  Â  Â  Â  Â  Â  const email = document.getElementById('email').value.trim();
Â  Â  Â  Â  Â  Â  const message = document.getElementById('message').value.trim();
Â  Â  Â  Â  Â  Â  const formStatus = document.getElementById('formStatus');

Â  Â  Â  Â  Â  Â  formStatus.style.color = "black";
Â  Â  Â  Â  Â  Â  formStatus.textContent = "Sending...";

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "https://script.google.com/macros/s/AKfycbwr26uY61Dip94_QwzyLh1JDSIFdYHJgqL_scKGLdRd9O42VLDBvt2XzkA67tjphJrs/exec",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "text/plain" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ name, email, message, subject: "Unpublished News Feedback" })
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  );

Â  Â  Â  Â  Â  Â  Â  Â  if (res.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  formStatus.style.color = "green";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  formStatus.textContent = "âœ… Thanks for your feedback!";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  feedbackForm.reset();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  formStatus.style.color = "red";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  formStatus.textContent = "âŒ Error sending feedback.";
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  formStatus.style.color = "red";
Â  Â  Â  Â  Â  Â  Â  Â  formStatus.textContent = "âŒ Could not connect.";
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  }
});

</script>
<script>
// Convert Reddit-style markdown (**bold**, *italics*, `code`) to HTML
function convertMarkdown(text) {
Â  Â  return text
Â  Â  Â  Â  // Bold: **text** â†’ <strong>text</strong>
Â  Â  Â  Â  .replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>")
Â  Â  Â  Â  // Italics: *text* â†’ <em>text</em>
Â  Â  Â  Â  .replace(/\*(.*?)\*/g, "<em>$1</em>")
Â  Â  Â  Â  // Inline code: `text` â†’ <code>text</code>
Â  Â  Â  Â  .replace(/`(.*?)`/g, "<code>$1</code>");
}

// Correct toggleSummary â€” applies markdown just once
function toggleSummary(btn) {
Â  Â  const summaryEl = btn.nextElementSibling;

Â  Â  // Check if conversion is already done using a data attribute
Â  Â  if (!summaryEl.dataset.converted) {
Â  Â  Â  Â  // Get the original plain text content before conversion
Â  Â  Â  Â  summaryEl.innerHTML = convertMarkdown(summaryEl.textContent);
Â  Â  Â  Â  summaryEl.dataset.converted = "true";
Â  Â  }

Â  Â  summaryEl.classList.toggle('show');
Â  Â  btn.textContent = summaryEl.classList.contains('show')
Â  Â  Â  Â  ? 'Hide Story'
Â  Â  Â  Â  : 'Show Story';
}

</script>

</body>
</html>
